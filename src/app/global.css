@import 'tailwindcss';
@plugin "./hero";
@source "./**/*.{ts,tsx,mdx}" "../../content/**/*.{md,mdx}" "../../node_modules/@heroui/theme/dist/**/*.{js,ts,jsx,tsx}";
@custom-variant dark (&:is(.dark *));
@import 'fumadocs-ui/css/neutral.css';
@import 'fumadocs-ui/css/preset.css';
@import 'fumadocs-twoslash/twoslash.css';

@theme {
  --color-fd-primary: #6A66F4;
  --color-primary: var(--color-fd-primary);
}

:root {
  --color-fd-primary: #6A66F4;
  --app-sans: -apple-system, BlinkMacSystemFont, 'SF Pro Text', 'SF Pro Display', 'Segoe UI', Roboto,
    'Helvetica Neue', Arial, 'Noto Sans', 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol',
    'Noto Color Emoji', sans-serif;
}

.dark { --color-fd-primary: #6A66F4; }

html { font-family: var(--app-sans); }
body { font-feature-settings: 'ss01' on, 'cv05' on; }

:root {
  --toc-accent: var(--color-fd-primary);
  --toc-rail: color-mix(in oklab, var(--color-fd-primary) 20%, transparent);
  /* 表头背景（固定为 #F1F1F1） */
  --table-header-bg: #F1F1F1;
}

/* 暗色模式下的表头背景，避免出现白底白字 */
.dark { --table-header-bg: color-mix(in oklab, white 8%, transparent); }

/* =============== Inline TOC 目录凹凸线条样式（恢复） =============== */
nav[aria-label="Table of contents"],
nav[aria-label="目录"] {
  --_toc-rail: var(--toc-rail);
  --_toc-accent: var(--toc-accent);
}

nav[aria-label="Table of contents"] ol,
nav[aria-label="目录"] ol {
  position: relative;
  margin-left: 12px;
  border-left: 1.5px solid var(--_toc-rail);
  padding-left: 0;
}

/* 二级目录：在自身也绘制竖线，并通过“弯折线”连接，形成阶梯凹凸效果 */
nav[aria-label="Table of contents"] ol ol,
nav[aria-label="目录"] ol ol {
  margin-left: 18px;
  border-left: 1.5px solid var(--_toc-rail);
}

nav[aria-label="Table of contents"] li,
nav[aria-label="目录"] li {
  list-style: none;
  position: relative;
  padding-left: 12px;
  margin: 8px 0;
}

/* 连接弯折线：仅对二级及以上层级 li 生效 */
nav[aria-label="Table of contents"] ol ol > li::after,
nav[aria-label="目录"] ol ol > li::after {
  content: '';
  position: absolute;
  left: -18px; /* 与上面 ol ol 的 margin-left 呼应 */
  top: 0.9em; /* 与圆点对齐 */
  width: 18px;
  height: 18px;
  border-top: 1.5px solid var(--_toc-rail);
  border-left: 1.5px solid var(--_toc-rail);
  border-top-left-radius: 10px; /* 圆角转弯，形成“凸起”的视觉 */
  transform: translateY(-50%);
}

nav[aria-label="Table of contents"] li::before,
nav[aria-label="目录"] li::before {
  content: '';
  position: absolute;
  left: -9px;
  top: 0.9em;
  transform: translateY(-50%);
  width: 8px;
  height: 8px;
  border-radius: 9999px;
  background: var(--_toc-accent);
  box-shadow: 0 0 0 3px color-mix(in oklab, var(--_toc-accent) 12%, transparent);
}

nav[aria-label="Table of contents"] a,
nav[aria-label="目录"] a {
  display: inline-block;
  color: var(--fd-muted-foreground, color-mix(in oklab, #000 55%, transparent));
  text-decoration: none;
  padding: 2px 0;
}

nav[aria-label="Table of contents"] a:hover,
nav[aria-label="目录"] a:hover { color: var(--_toc-accent); }

nav[aria-label="Table of contents"] a[aria-current],
nav[aria-label="目录"] a[aria-current],
nav[aria-label="Table of contents"] a[aria-current="page"],
nav[aria-label="目录"] a[aria-current="page"],
nav[aria-label="Table of contents"] a[data-active="true"],
nav[aria-label="目录"] a[data-active="true"] {
  color: var(--_toc-accent);
  font-weight: 600;
}

/* =============== 表格样式 =============== */
/* 说明：Fumadocs Typography 默认使用 roundedTable，会给 table 设置灰色卡片背景。
   这里强制移除 table 背景，保留你指定的表头色（#F1F1F1），正文透明。*/

/* 去除容器灰背景（覆盖 roundedTable 的 table 背景） */
.prose table,
.fd-article table,
article table { background-color: transparent !important; background: none !important; }

/* 表头（或首行）灰色 + 加粗 */
.fd-article table thead th,
article.fd-article table thead th,
.prose table thead th,
article table thead th { font-weight: 700 !important; background-color: var(--table-header-bg) !important; }

/* 暗色模式下，确保表头文字颜色对比充分 */
.dark :is(.fd-article table thead th,
article.fd-article table thead th,
.prose table thead th,
article table thead th) { color: var(--fd-foreground, #fff) !important; }

/* 无 thead 时，将第一行视作表头 */
.fd-article table:not(:has(thead)) tr:first-child > th,
.fd-article table:not(:has(thead)) tr:first-child > td,
.prose table:not(:has(thead)) tr:first-child > th,
.prose table:not(:has(thead)) tr:first-child > td,
article table:not(:has(thead)) tr:first-child > th,
article table:not(:has(thead)) tr:first-child > td { font-weight: 700 !important; background-color: var(--table-header-bg) !important; }

/* 暗色模式下，首行视作表头时也保持足够的文字对比度 */
.dark :is(.fd-article table:not(:has(thead)) tr:first-child > th,
.fd-article table:not(:has(thead)) tr:first-child > td,
.prose table:not(:has(thead)) tr:first-child > th,
.prose table:not(:has(thead)) tr:first-child > td,
article table:not(:has(thead)) tr:first-child > th,
article table:not(:has(thead)) tr:first-child > td) { color: var(--fd-foreground, #fff) !important; }

/* 正文无背景 */
.fd-article table tbody tr,
.prose table tbody tr,
article table tbody tr { background-color: transparent !important; }

/* 兜底：清除单元格上的背景，避免第三方样式在 td 上着色 */
.fd-article table tbody td,
.prose table tbody td,
article table tbody td { background-color: transparent !important; }

/* 保持单元格内 strong/b 加粗不变 */
.fd-article table tbody tr td strong,
.fd-article table tbody tr td b,
.prose table tbody tr td b,
article table tbody tr td b,
article table tbody tr td strong,
article table tbody tr td strong {
  font-weight: 700 !important;
}

/* =============== 其他通用样式 =============== */
.animate-marquee {
  animation: marquee var(--marquee-duration, 40s) linear infinite;
}

.group:hover .animate-marquee {
  animation-play-state: paused;
}

@keyframes marquee {
  from {
    transform: translateX(0);
  }
  to {
    transform: translateX(-50%);
  }
}

@keyframes marquee_reverse {
  from {
    transform: translateX(-50%);
  }
  to {
    transform: translateX(0);
  }
}

/* Hide scrollbars for horizontal snapping containers on mobile */
.no-scrollbar::-webkit-scrollbar { display: none; }
.no-scrollbar {
  -ms-overflow-style: none; /* IE/Edge */
  scrollbar-width: none;    /* Firefox */
}

/* Home page light-mode typography color overrides */
:root :is(main[data-home]) {
  /* Base text color */
  color: #1D1D1F;
}

/* Ensure typical text utility variables align with this base where used by Fumadocs */
:root :is(main[data-home]) {
  --fd-foreground: #1D1D1F;
  --fd-card-foreground: #1D1D1F;
  --fd-muted-foreground: color-mix(in oklab, #1D1D1F 60%, transparent);
}

/* Do not affect dark mode */
.dark :is(main[data-home]) {
  color: inherit;
  --fd-foreground: inherit;
  --fd-card-foreground: inherit;
  --fd-muted-foreground: inherit;
}

/* =============== Markdown 列表样式 =============== */
/* 有序列表序号颜色 */
.prose ol > li::marker,
.fd-article ol > li::marker,
article ol > li::marker {
  color: #6A66F4;
}

/* 无序列表符号颜色 */
.prose ul > li::marker,
.fd-article ul > li::marker,
article ul > li::marker {
  color: #6A66F4;
}

/* 嵌套列表也应用相同样式 */
.prose ol ol > li::marker,
.prose ol ul > li::marker,
.prose ul ol > li::marker,
.prose ul ul > li::marker,
.fd-article ol ol > li::marker,
.fd-article ol ul > li::marker,
.fd-article ul ol > li::marker,
.fd-article ul ul > li::marker,
article ol ol > li::marker,
article ol ul > li::marker,
article ul ol > li::marker,
article ul ul > li::marker {
  color: #6A66F4;
}
